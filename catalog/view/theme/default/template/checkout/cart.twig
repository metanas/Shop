{{ header }}
<div id="checkout-cart" class="container">
    {% if attention %}
        <div class="alert alert-info"><i class="fa fa-info-circle"></i> {{ attention }}
            <button type="button" class="close" data-dismiss="alert">&times;</button>
        </div>
    {% endif %}
    {% if success %}
        <div class="alert alert-success alert-dismissible"><i class="fa fa-check-circle"></i> {{ success }}
            <button type="button" class="close" data-dismiss="alert">&times;</button>
        </div>
    {% endif %}
    {% if error_warning %}
        <div class="alert alert-danger alert-dismissible"><i class="fa fa-exclamation-circle"></i> {{ error_warning }}
            <button type="button" class="close" data-dismiss="alert">&times;</button>
        </div>
    {% endif %}
    <div id="c_row" class="row">{{ column_left }}
        {% if column_left and column_right %}
            {% set class = 'col-sm-6' %}
        {% elseif column_left or column_right %}
            {% set class = 'col-sm-9' %}
        {% else %}
            {% set class = 'col-sm-12' %}
        {% endif %}
        <div id="content c_content" class="{{ class }}">{{ content_top }}
            <div id="c_cart_layout_left" class="col-md-8 col-xs-12">
                <div id="c_products_content">
                    <h2 id="c_cart_head_title">{{ heading_title }}
                        {% if total_products > 1 %}
                            &nbsp;({{ total_products }} articles)
                        {% else %}
                            ({{ total_products }} article)
                        {% endif %} </h2>
                    <div class="col-sm-12">
                        <div class="row">
                            {% for product in products %}
                            <div id="r{{ loop.index }}" class="col-md-2 col-sm-2">
                                {% if product.thumb %}
                                    <a href="{{ product.href }}">
                                        <img src="{{ product.thumb }}"
                                             alt="{{ product.name }}"
                                             title="{{ product.name }}"
                                             class="img-responsive"/>
                                    </a>
                                {% endif %}
                            </div>
                            <div id="r{{ loop.index }}" class="col-md-10 col-sm-10">
                                <div class="col-sm-12">
                                    <div class="row">
                                        <div class="col-sm-8">
                                            <div class="row">
                                                <div><a href="{{ product.href }}">{{ product.model }}</a></div>
                                                <div><a href="{{ product.href }}">{{ product.name }}</a></div>
                                            </div>
                                        </div>
                                        <div class="col-sm-4">
                                            <div class="input-group btn-block">
                                                <select name="quantity[{{ product.cart_id }}]" class="select-zalark">
                                                    {% for i in 1..product.max_quantity %}
                                                        <option value="{{ i }}" {% if product.quantity == i %} selected {% endif %}>{{ i }}</option>
                                                    {% endfor %}
                                                </select>
                                                <i class="fa fa-angle-down"
                                                   style="position: absolute;padding: 13px;cursor: pointer;right: 0;top: 0;"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div>Couleur : {{ product.color }}</div>
                                {% if product.option %}
                                    {% for option in product.option %}
                                        <div>{{ option.name }}: {{ option.value }}</div>
                                    {% endfor %}
                                {% endif %}
                                <div>
                                    <button style="background-color: inherit; border:0;"
                                            onclick="cart.remove('{{ product.cart_id }}');">
                                        <span class="glyphicon glyphicon-trash" style="color: grey;"> Supprimer</span>
                                    </button>
                                    |
                                    <button style="background-color: inherit; border:0"
                                            onclick="wishlist.add('{{ product.cart_id }}')">
                                        <span class="glyphicon glyphicon-heart-empty" style="color: grey;">Déplacer vers mes préférés</span>
                                    </button>
                                </div>
                            </div>
                            <div id="r{{ loop.index }}" class="text-right">
                                {% if product.old_price %}
                                    <span class="pull-right price-old">{{ product.old_price }}</span><br>
                                    <span id="r{{ loop.index }}"
                                          class="c_price pull-right price-new">{{ product.total }}</span>
                                {% else %}
                                    <span id="r{{ loop.index }}"
                                          class="c_price pull-right">{{ product.total }}</span>
                                {% endif %}
                            </div>
                        </div>
                        {% endfor %}
                        {% for voucher in vouchers %}
                            <tr>
                                <td></td>
                                <td class="text-left">{{ voucher.description }}</td>
                                <td class="text-left"></td>
                                <td class="text-left">
                                    <div class="input-group btn-block" style="max-width: 200px;">
                                        <input type="text" name="" value="1" size="1" disabled="disabled"
                                               class="form-control"/>
                                        <div class="input-group-btn">
                                            <button type="button" data-toggle="tooltip"
                                                    title="{{ button_remove }}" class="btn btn-danger"
                                                    onclick="voucher.remove('{{ voucher.key }}');"><i
                                                        class="fa fa-times-circle"></i></button>
                                        </div>
                                    </div>
                                </td>
                                <td class="text-right">{{ voucher.amount }}</td>
                                <td class="text-right">{{ voucher.amount }}</td>
                            </tr>
                        {% endfor %}
                    </div>


                    <p class="c_info"><span class="glyphicon glyphicon-asterisk"></span> Les articles dans le panier ne
                        sont pas reservés</p>
                </div>
                {#{% if modules %}#}
                {#<h2>{{ text_next }}</h2>#}
                {#<p>{{ text_next_choice }}</p>#}
                {#<div class="panel-group" id="accordion">{% for module in modules %}#}
                {#{{ module }}#}
                {#{% endfor %} </div>#}
                {#{% endif %} <br />#}
                <div style="background-color: white">
                    <h2 style="padding: 25px 0 0 25px">Livraison estimée</h2>
                    <p>date</p>
                    <p class="c_info"><span class="glyphicon glyphicon-asterisk"></span> Vous pouvez sélectionner notre
                        service de livraison rapide à la fin de votre commande</p>
                </div>
                <div style="background-color: white; margin-bottom: 25px;">
                    <h2 style="padding: 25px 0 0 25px">Nous acceptons</h2>
                    <div style="padding-bottom: 25px">
                        <img class="w50" src="catalog/view/theme/default/image/master2.png">
                        <img class="w50" src="catalog/view/theme/default/image/visa2.png">
                        <img class="w50" src="catalog/view/theme/default/image/livraison2.png">
                        <img class="w50" src="catalog/view/theme/default/image/paypal2.png">
                    </div>

                </div>
            </div>
            <div id="c_cart_layout_right" class="col-md-4 col-xs-12">
                <div id="c_c_total" class="row">
                    <h2 id="c_cart_head_title">Total</h2>
                    <div class="col-sm-12">
                        {% set tot = totals|first %}

                        <div class="text-left col-sm-6" style="margin-bottom: 20px">{{ tot.title }}</div>
                        <div class="text-right col-sm-6" id="sub-total" style="margin-bottom: 20px">{{ tot.text }}</div>
                        <br>

                        <div class="text-left col-sm-8" style="margin-bottom: 20px">Livraison</div>
                        <div class="text-right col-sm-4" style="margin-bottom: 20px">gratuite</div>
                        <br>
                        {% set total = totals|last %}
                        <div class="text-left col-sm-6" style="margin-bottom: 20px"><strong>{{ total.title }}(TVA
                                incluse)</strong></div>
                        <div class="text-right col-sm-6" id="total" style="margin-bottom: 20px">
                            <strong>{{ total.text }}</strong>
                        </div>
                        <br>

                    </div>
                    <div class="col-sm-12" style="padding-left: 28px; padding-right: 28px;"><a
                                style="background-color:#ff1b5e; width: 100%; margin-bottom: 25px; border-radius: 0"
                                href="{{ checkout }}" class="btn btn-primary">Commander</a></div>
                </div>
                <div id="c_c_buttons" class="buttons clearfix">
                    <div id="c_c_total" class="row">
                        <div style="background-color: white; padding: 30px">
                            Vous avez une carte cadeau ou un code promo? Vous pouvez les utiliser à la dernière étape de
                            la commande.
                        </div>
                    </div>
                </div>
            </div>
            {{ content_bottom }}</div>
        {{ column_right }}</div>
</div>
<script>
    $(".select-zalark").change(function () {
        var name = this.name.split("[")[1];
        var cart_id = name.substr(0, name.length);
        var quantity = this.value;
        var s = $(this);
        $.ajax({
            url: "index.php?route=checkout/cart/edit",
            type: "POST",
            data: {"cart_id": cart_id, "quantity": quantity},
            success: function (json) {
                if (json['success']) {
                    $('#sub-total').html(json['total']);
                    $('#total').html("<b>" + json['total'] + "</b>");
                    s.parents('.text-left').children('.c_price').html(json['price']);
                    if (json['old_price']) {
                        s.parents('.text-left').children('.price-old').html(json['old_price'])
                    }
                }
            },
            error: function () {

            }
        })
    })
</script>
{{ footer }}
